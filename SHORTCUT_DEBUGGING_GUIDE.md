# 🔧 快捷鍵調試指南

## 當前問題診斷

如果快捷鍵不工作，請按照以下步驟進行診斷：

## 🧪 測試步驟

### 1. 基本測試
1. 打開 `http://localhost:8083`
2. 打開瀏覽器開發者工具（F12）
3. 切換到 Console 標籤頁
4. 點擊頁面任意位置確保頁面有焦點

### 2. 測試隱藏的管理員按鈕
1. 在歡迎頁面底部（條款文字下方）有一個隱藏的透明區域
2. 點擊該區域應該會顯示管理員提示框
3. 如果提示框出現，點擊紅色的 "🔑 測試管理員登入" 按鈕
4. 這將直接測試管理員登入功能

### 3. 測試快捷鍵
#### 方法一：Ctrl + Alt + H（顯示提示）
1. 同時按住 `Ctrl` + `Alt` + `H`
2. 檢查控制台是否有日誌輸出
3. 檢查是否顯示管理員提示框

#### 方法二：Ctrl + Alt + A（管理員登入）
1. 同時按住 `Ctrl` + `Alt` + `A`
2. 檢查控制台是否有日誌輸出
3. 檢查是否觸發管理員登入

#### 方法三：Escape 序列
1. 快速連續按三次 `Esc` 鍵（2秒內）
2. 檢查控制台是否有 Escape 序列日誌
3. 檢查是否觸發管理員登入

## 🔍 調試信息

### 控制台日誌
您應該看到以下類型的日誌：

```
🔑 鍵盤事件: KeyDownEvent - LogicalKeyboardKey#xxxxx
🔑 當前按下的鍵: {LogicalKeyboardKey#xxxxx, ...}
🔑 觸發管理員登入快捷鍵！
🔑 觸發顯示提示快捷鍵！
🔑 檢測到 Escape 鍵
🔑 Escape 序列: 1/3
🔑 Escape 序列: 2/3
🔑 Escape 序列: 3/3
🔑 Escape 序列觸發管理員登入！
```

### 如果沒有看到任何日誌
這表示鍵盤事件沒有被捕獲，可能的原因：
1. 頁面沒有焦點
2. KeyboardListener 沒有正確設置
3. 瀏覽器阻止了事件

### 如果看到鍵盤事件但快捷鍵不觸發
檢查按鍵組合是否正確：
- 確保同時按下所有需要的鍵
- 檢查鍵盤佈局（某些鍵盤可能有不同的鍵碼）

## 🛠️ 故障排除

### 問題 1：頁面沒有焦點
**症狀**：沒有任何鍵盤事件日誌
**解決方案**：
1. 點擊頁面任意位置
2. 確保沒有其他元素獲得焦點
3. 刷新頁面重試

### 問題 2：瀏覽器攔截快捷鍵
**症狀**：看到鍵盤事件但快捷鍵不觸發
**解決方案**：
1. 嘗試使用 Escape 序列（不會被瀏覽器攔截）
2. 檢查瀏覽器擴展是否攔截快捷鍵
3. 嘗試在無痕模式下測試

### 問題 3：鍵盤佈局問題
**症狀**：某些鍵不被識別
**解決方案**：
1. 檢查控制台中顯示的鍵碼
2. 確保使用標準 QWERTY 鍵盤佈局
3. 嘗試使用不同的鍵（左右 Ctrl/Alt）

### 問題 4：Firebase 連接問題
**症狀**：快捷鍵觸發但登入失敗
**解決方案**：
1. 檢查網絡連接
2. 檢查 Firebase 配置
3. 查看控制台中的錯誤信息

## 🔧 手動測試方法

如果快捷鍵完全不工作，您可以：

### 方法 1：使用隱藏按鈕
1. 在歡迎頁面底部點擊隱藏區域
2. 點擊 "🔑 測試管理員登入" 按鈕

### 方法 2：瀏覽器控制台
1. 打開開發者工具
2. 在 Console 中輸入：
```javascript
// 觸發管理員登入
window.flutter_app?._adminQuickLogin?.();
```

### 方法 3：直接修改代碼
臨時添加一個可見的測試按鈕：

```dart
// 在 welcome_screen.dart 中添加
ElevatedButton(
  onPressed: _adminQuickLogin,
  child: Text('管理員登入'),
)
```

## 📊 性能檢查

### 檢查 FocusNode 狀態
在控制台中檢查：
```javascript
// 檢查焦點狀態
console.log('Focus node has focus:', document.activeElement);
```

### 檢查事件監聽器
```javascript
// 檢查是否有鍵盤事件監聽器
console.log('Event listeners:', getEventListeners(document));
```

## 🎯 預期行為

### 成功的快捷鍵測試應該：
1. ✅ 在控制台看到鍵盤事件日誌
2. ✅ 看到按鍵組合被正確識別
3. ✅ 觸發相應的功能（顯示提示或登入）
4. ✅ 顯示成功或失敗的提示信息

### 成功的管理員登入應該：
1. ✅ 顯示 "🔑 管理員登入成功！" 綠色提示
2. ✅ 自動跳轉到主頁面
3. ✅ 在個人檔案頁面看到管理員面板入口

## 🚨 緊急備用方案

如果所有快捷鍵都不工作，您可以：

1. **修改代碼添加可見按鈕**
2. **使用 Firebase 控制台直接創建管理員用戶**
3. **修改 AuthWrapper 跳過登入檢查**

請告訴我您在測試過程中看到了什麼日誌信息，這將幫助我進一步診斷問題。 