# Amore 管理員系統

## 概述

Amore 應用配備了完整的管理員系統，提供系統管理、用戶管理和測試工具功能。管理員可以通過特殊的快捷鍵快速登入，無需經過正常的註冊流程。

## 管理員登入

### 快捷鍵登入
在歡迎頁面使用以下快捷鍵組合：

- **Ctrl + Alt + A**: 管理員快速登入
- **Ctrl + Alt + H**: 顯示/隱藏快捷鍵提示
- **Esc × 3**: 連續按三次 Escape 鍵快速管理員登入（2秒內）

### 管理員憑證
- **電子郵件**: `admin@amore.hk`
- **密碼**: `AmoreAdmin2024!`
- **用戶ID**: `admin_user_001`

## 管理員功能

### 1. 系統統計
- 總用戶數統計
- 活躍用戶數（7天內活躍）
- 總消息數統計
- AI 分析次數統計

### 2. 用戶管理
- **重置用戶密碼**: 為指定用戶發送密碼重置郵件
- **用戶權限管理**: 檢查和管理用戶權限

### 3. 數據管理
- **清理測試數據**: 刪除所有測試消息和臨時數據
- **數據備份**: 系統數據備份功能（計劃中）
- **數據分析**: 深度數據分析報告（計劃中）

### 4. 測試工具
- **創建測試用戶**: 生成測試用戶檔案用於開發測試
- **生成測試聊天**: 創建測試聊天記錄用於 AI 分析測試
- **模擬數據生成**: 生成各種測試數據

## 技術實現

### AdminService 類
```dart
class AdminService {
  // 管理員快速登入
  static Future<bool> adminQuickLogin()
  
  // 檢查當前用戶是否為管理員
  static bool isCurrentUserAdmin()
  
  // 重置用戶密碼
  static Future<bool> resetUserPassword(String email)
  
  // 獲取用戶統計
  static Future<Map<String, dynamic>> getUserStats()
  
  // 清理測試數據
  static Future<bool> cleanupTestData()
  
  // 創建測試用戶
  static Future<bool> createTestUsers()
  
  // 生成測試聊天記錄
  static Future<bool> generateTestChatData()
}
```

### 管理員檔案結構
```dart
{
  'id': 'admin_user_001',
  'email': 'admin@amore.hk',
  'name': 'Admin',
  'age': 30,
  'mbtiType': 'INTJ',
  'interests': ['管理', '分析', '技術'],
  'bio': 'Amore 系統管理員',
  'isAdmin': true,
  'profileComplete': true,
  // ... 其他標準用戶字段
}
```

## 安全措施

### 權限檢查
- 所有管理員功能都會檢查 `isCurrentUserAdmin()` 權限
- 非管理員用戶無法訪問管理員面板
- 敏感操作需要二次確認

### 數據保護
- 管理員操作會記錄日誌
- 重要操作需要確認對話框
- 測試數據與正式數據分離

### 訪問控制
- 管理員面板僅對管理員用戶可見
- 快捷鍵登入有特殊的視覺提示
- 管理員狀態在 Firebase 中標記

## 使用指南

### 首次設置
1. 在歡迎頁面按 `Ctrl + Alt + H` 顯示快捷鍵提示
2. 按 `Ctrl + Alt + A` 進行管理員登入（或連續按三次 Esc 鍵）
3. 系統會自動創建管理員帳戶（如果不存在）
4. 登入成功後可在個人檔案頁面看到管理員面板入口

### 日常管理
1. **查看系統統計**: 在管理員面板首頁查看實時統計
2. **用戶支援**: 使用密碼重置功能幫助用戶
3. **數據維護**: 定期清理測試數據保持系統整潔
4. **測試準備**: 創建測試用戶和聊天記錄用於功能測試

### 測試流程
1. **創建測試用戶**: 生成 Sarah、Emma、Lily 等測試用戶
2. **生成測試聊天**: 創建與測試用戶的聊天記錄
3. **測試 AI 分析**: 使用測試數據驗證 AI 對話分析功能
4. **清理數據**: 測試完成後清理測試數據

## 測試用戶

系統會創建以下測試用戶：

### Test Sarah
- **姓名**: Test Sarah
- **年齡**: 25
- **MBTI**: ENFP
- **電子郵件**: test.sarah@amore.hk
- **簡介**: 測試用戶 - Sarah

### Test Emma
- **姓名**: Test Emma
- **年齡**: 28
- **MBTI**: INFJ
- **電子郵件**: test.emma@amore.hk
- **簡介**: 測試用戶 - Emma

### Test Lily
- **姓名**: Test Lily
- **年齡**: 26
- **MBTI**: ISFP
- **電子郵件**: test.lily@amore.hk
- **簡介**: 測試用戶 - Lily

## 測試聊天記錄

系統會生成以下測試聊天：

```
與 Test Sarah 的對話：
- "你好！很高興認識你 😊"
- "你好！我也很高興認識你"
- "你平時喜歡做什麼呢？我很喜歡旅行和攝影"

與 Test Emma 的對話：
- "嗨，看到你的檔案覺得我們有很多共同點"
- "真的嗎？我也這麼覺得！"
```

## 故障排除

### 常見問題

**Q: 快捷鍵不起作用？**
A: 確保頁面有焦點，嘗試點擊頁面後再按快捷鍵。

**Q: 管理員登入失敗？**
A: 檢查網絡連接和 Firebase 配置，系統會自動創建管理員帳戶。

**Q: 看不到管理員面板？**
A: 確保已成功以管理員身份登入，檢查 `isCurrentUserAdmin()` 狀態。

**Q: 統計數據不準確？**
A: 點擊刷新按鈕重新載入統計，檢查 Firebase 數據庫連接。

### 日誌檢查
管理員操作會在控制台輸出詳細日誌：
- ✅ 成功操作
- ❌ 失敗操作
- 📊 統計信息
- 🔧 系統狀態

## 未來功能

### 計劃中的功能
- **用戶行為分析**: 詳細的用戶行為統計和分析
- **系統監控**: 實時系統性能監控
- **自動化測試**: 自動化的功能測試套件
- **數據導出**: 系統數據導出和報告生成
- **通知系統**: 管理員通知和警報系統

### 安全增強
- **雙因素認證**: 管理員登入的額外安全層
- **操作審計**: 完整的管理員操作審計日誌
- **IP 限制**: 限制管理員登入的 IP 地址
- **會話管理**: 管理員會話超時和管理

---

這個管理員系統為 Amore 應用提供了完整的後台管理能力，確保系統的穩定運行和高效維護。 